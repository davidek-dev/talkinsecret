---
interface Props {
  videoUrl: string;
}

const { videoUrl } = Astro.props;

// YouTube Video ID extrahieren
const getYouTubeID = (url: string) => {
  const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
  const match = url.match(regExp);
  return match && match[2].length === 11 ? match[2] : null;
};

const videoID = getYouTubeID(videoUrl);
const embedUrl = `https://www.youtube.com/embed/${videoID}?enablejsapi=1&version=3&playerapiid=ytplayer`;
---

<!-- Font Awesome einbinden -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
	#video-container {
	  display: flex;
	  flex-direction: column;
	  justify-content: center;
	  align-items: center;
	  height: 394px;
	  width: 700px;
	  border: 3px solid #884d45;
	  border-radius: 5px;
	  position: relative;
	  cursor: none; /* Cursor ausblenden */
	  max-width: 100%;
	}
	
  /* Gemeinsame Basis-Styles für Play Button und Custom Cursor */
  .circle-button {
    width: 120px;
    height: 120px;
    border: 3px solid #884d45;
    border-radius: 50%;
    background-color: rgba(218, 227, 218, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  #play-button {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    opacity: 1;
    transition: opacity 0.2s ease;
    cursor: none;
  }

  #custom-cursor {
    position: fixed;
    pointer-events: none;
    z-index: 9999;
    display: none;
    transform: translate(-50%, -50%);
  }

  /* Gemeinsame Icon-Styles */
  .play-icon, 
  .pause-icon,
  #custom-cursor i {
    font-size: 40px;
    color: #884d45;
  }
  </style>


<div id="custom-cursor" class="circle-button">
	<i class="fa fa-solid fa-play"></i>
  </div>
  
  <div id="video-container">
	<video id="video" preload="metadata">
	  <source id="video-source" type="video/mp4">
	</video>
	<button id="play-button" class="circle-button">
	  <span class="play-icon">
		<i class="fa fa-solid fa-play"></i>
	  </span>
	</button>
  </div>

  
  <script>
	document.addEventListener('DOMContentLoaded', () => {
	  const videoContainer = document.getElementById("video-container");
	  const playButton = document.getElementById("play-button");
	  const video = document.getElementById("video");
	  const videoSource = document.getElementById("video-source");
	  const customCursor = document.getElementById("custom-cursor");
	  
	  if (!videoContainer || !playButton || !video || !videoSource || !customCursor) {
		console.error("Erforderliche DOM-Elemente nicht gefunden");
		return;
	  }
	
	  // Custom Cursor Bewegung
	  videoContainer.addEventListener('mousemove', (e) => {
		const rect = videoContainer.getBoundingClientRect();
		if (e.clientX >= rect.left && e.clientX <= rect.right &&
			e.clientY >= rect.top && e.clientY <= rect.bottom) {
		  customCursor.style.display = 'flex';
		  customCursor.style.justifyContent = 'center';
		  customCursor.style.alignItems = 'center';
		  customCursor.style.left = `${e.clientX}px`;
		  customCursor.style.top = `${e.clientY}px`;
		  playButton.style.opacity = "0";
		}
	  });
	
	  videoContainer.addEventListener('mouseenter', () => {
		customCursor.style.display = 'flex';
		playButton.style.opacity = "0";
	  });
	
	  videoContainer.addEventListener('mouseleave', () => {
		customCursor.style.display = 'none';
		if (video.paused) {
		  playButton.style.opacity = "1";
		}
	  });
	
	  video.addEventListener("play", () => {
		playButton.style.opacity = "0";
		customCursor.innerHTML = '<i class="fa fa-solid fa-pause" style="font-size: 40px; color: #884d45;"></i>';
	  });
	  
	  video.addEventListener("pause", () => {
		playButton.style.opacity = "1";
		customCursor.innerHTML = '<i class="fa fa-solid fa-play" style="font-size: 40px; color: #884d45;"></i>';
	  });
	
	  videoContainer.addEventListener("click", () => {
		if (video.paused) {
		  video.play()
			.catch(error => console.error("Videowiedergabe fehlgeschlagen:", error));
		  playButton.innerHTML = '<span class="pause-icon"><i class="fa fa-solid fa-pause" style="font-size: 40px; color: #884d45;"></i></span>';
		  customCursor.innerHTML = '<i class="fa fa-solid fa-pause" style="font-size: 40px; color: #884d45;"></i>';
		} else {
		  video.pause();
		  playButton.innerHTML = '<span class="play-icon"><i class="fa fa-solid fa-play" style="font-size: 40px; color: #884d45;"></i></span>';
		  customCursor.innerHTML = '<i class="fa fa-solid fa-play" style="font-size: 40px; color: #884d45;"></i>';
		}
	  });
	
	  video.addEventListener("ended", () => {
		playButton.innerHTML = '<span class="play-icon"><i class="fa fa-solid fa-play" style="font-size: 40px; color: #884d45;"></i></span>';
		playButton.style.opacity = "1";
		customCursor.innerHTML = '<i class="fa fa-solid fa-play" style="font-size: 40px; color: #884d45;"></i>';
	  });
	}); // DOMContentLoaded Event Handler schließen
	</script>